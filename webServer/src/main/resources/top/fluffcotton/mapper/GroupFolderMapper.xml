<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="top.fluffcotton.mapper.GroupFolderMapper">
    <resultMap id="GroupResultMap" type="top.fluffcotton.pojo.QqGroup">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Sun Aug 23 22:03:47 CST 2020.
        -->
        <id column="groupID" jdbcType="CHAR" property="groupid"/>
        <result column="groupList" jdbcType="CHAR" property="grouplist"/>
        <result column="power" jdbcType="TINYINT" property="power"/>
        <result column="isBan" jdbcType="BIT" property="isban"/>
        <result column="groupName" jdbcType="VARCHAR" property="groupname"/>
    </resultMap>

    <resultMap id="FolderResultMap" type="top.fluffcotton.pojo.Folder">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Sun Aug 23 22:38:28 CST 2020.
        -->
        <id column="fileId" jdbcType="INTEGER" property="fileid"/>
        <result column="fileName" jdbcType="VARCHAR" property="filename"/>
        <result column="userID" jdbcType="CHAR" property="userid"/>
    </resultMap>

    <sql id="Group_Column_List">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Sun Aug 23 22:03:47 CST 2020.
        -->
        qq_group.groupID groupID, groupList, power, isBan, groupName
    </sql>
    <sql id="Folder_Column_List">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Sun Aug 23 22:38:28 CST 2020.
        -->
        folder.fileId fileId, fileName, userID
    </sql>

    <select id="selectQqGroupByUser" parameterType="top.fluffcotton.pojo.UserSelect" resultMap="GroupResultMap">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Sun Aug 23 22:03:47 CST 2020.
        -->
        select distinct
        <include refid="Group_Column_List"/>
        from qq_group, group_user
        where qq_group.deleteTime = 0 and qq_group.groupID = group_user.groupID and group_user.userID = #{id}
        <if test="isRoot">
            and qq_group.isRoot = #{isRoot}
        </if>
        order by qq_group.groupID
    </select>

    <select id="selectQqGroupByFolder" parameterType="top.fluffcotton.pojo.Folder" resultMap="GroupResultMap">
        select distinct
        <include refid="Group_Column_List"/>
        from folder_group, qq_group
        where qq_group.deleteTime = 0 and qq_group.groupID = folder_group.groupId and folder_group.folderId = #{fileid}
        order by qq_group.groupID
    </select>


    <select id="selectFolderByFolder" parameterType="top.fluffcotton.pojo.Folder" resultMap="FolderResultMap">
        select distinct
        <include refid="Folder_Column_List"/>
        from folder_group, folder
        where folder.deleteTime = 0 and folder_group.childrenId = folder.fileId and folder_group.folderId = #{fileid}
        order by folder.fileId
    </select>

</mapper>